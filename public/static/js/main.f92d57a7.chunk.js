(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{101:function(e,n){},125:function(e,n){},127:function(e,n){},140:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),l=t(63),c=t.n(l),o=(t(74),t(32)),i=t(6),u=t(145),m=(t(38),t(142)),s=t(146),E=function(e){return r.a.createElement(m.a,{className:"text-center"},r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("h1",null,"P2P File Transfer"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(s.a,{className:"btn btn-danger",onClick:function(){var n=Object(u.a)();e.history.push("/room/".concat(n))}},"Create room"))},f=t(13),d=t(65),b=t.n(d),g=t(34),h=t.n(g),v=t(66),p=t.n(v),w=t(144),j=t(143),O=new Worker("../worker.js"),k=function(e){var n=Object(a.useState)(!1),t=Object(f.a)(n,2),l=t[0],c=t[1],o=Object(a.useState)(),u=Object(f.a)(o,2),E=u[0],d=u[1],g=Object(a.useState)(!1),v=Object(f.a)(g,2),k=v[0],y=v[1],S=Object(i.f)(),C=Object(a.useRef)(),x=Object(a.useRef)(),N=Object(a.useRef)(""),W=e.match.params.roomID;function I(e){if(e.toString().includes("done")){y(!0);var n=JSON.parse(e);N.current=n.fileName}else O.postMessage(e)}Object(a.useEffect)((function(){C.current=b.a.connect("/"),C.current.emit("join room",W),C.current.on("all users",(function(e){x.current=function(e,n){var t=new h.a({initiator:!0,trickle:!1});return t.on("signal",(function(t){C.current.emit("sending signal",{userToSignal:e,callerID:n,signal:t})})),t.on("data",I),t}(e[0],C.current.id)})),C.current.on("user joined",(function(e){x.current=function(e,n){var t=new h.a({initiator:!1,trickle:!1});return t.on("signal",(function(e){C.current.emit("returning signal",{signal:e,callerID:n})})),t.on("data",I),t.signal(e),c(!0),t}(e.signal,e.callerID)})),C.current.on("receiving returned signal",(function(e){x.current.signal(e.signal),c(!0)})),C.current.on("room full",(function(){alert("room is full"),S.goBack()}))}),[]);var R,D;return R=l?r.a.createElement(m.a,{className:"text-center"},r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("h1",null,"Connected With Peer (You can Share or Transfer Files)"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(w.a,null,r.a.createElement(w.a.Label,null,"Select the File:"),r.a.createElement(w.a.Control,{size:"lg",onChange:function(e){d(e.target.files[0])},type:"file"})),r.a.createElement("br",null),r.a.createElement(s.a,{onClick:function(){var e=x.current,n=E.stream();console.log(n);var t=n.getReader();console.log(t),t.read().then((function(n){!function n(a,r){if(a)return void e.write(JSON.stringify({done:!0,fileName:E.name}));e.write(r),t.read().then((function(e){n(e.done,e.value)}))}(n.done,n.value)}))}},"Send file")):r.a.createElement(m.a,{className:"text-center"},r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("h1",null,"Waiting for the Peer to Join"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(j.a,{animation:"grow",variant:"primary"}),r.a.createElement(j.a,{animation:"grow",variant:"success"}),r.a.createElement(j.a,{animation:"grow",variant:"danger"}),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(w.a,null,r.a.createElement(w.a.Group,null,r.a.createElement(w.a.Label,null,"Your Room URL: (Share with Anyone in World)"),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement(w.a.Control,{size:"lg",id:"text",type:"text",value:window.location.href,readOnly:!0})),r.a.createElement("br",null),r.a.createElement(s.a,{onClick:function(){document.getElementById("text").select(),document.execCommand("copy")},variant:"primary"},"Copy to Clipboard"))),k&&(D=r.a.createElement(m.a,{className:"text-center"},r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("h3",null,"You have received a file. Would you like to download the file?"),r.a.createElement("br",null),r.a.createElement(s.a,{onClick:function(){y(!1),O.postMessage("download"),O.addEventListener("message",(function(e){var n=e.data.stream(),t=p.a.createWriteStream(N.current);n.pipeTo(t)}))}},"Yes"))),r.a.createElement(m.a,null,R,D)};var y=function(){return r.a.createElement(o.a,null,r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/",exact:!0,component:E}),r.a.createElement(i.a,{path:"/room/:roomID",component:k})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(y,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},69:function(e,n,t){e.exports=t(140)},74:function(e,n,t){}},[[69,1,2]]]);
//# sourceMappingURL=main.f92d57a7.chunk.js.map